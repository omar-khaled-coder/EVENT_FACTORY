<script>
document.addEventListener('DOMContentLoaded', () => {
  const thumbnails = document.querySelectorAll('.thumbnail');
  const carousel = document.querySelector('#carouselExample');
  const bootstrapCarousel = new bootstrap.Carousel(carousel);

  thumbnails.forEach((thumbnail, index) => {
    thumbnail.addEventListener('click', (event) => {
      // Remove active class from all thumbnails
      thumbnails.forEach(thumbnail => thumbnail.classList.remove('active'));

      // Add active class to the clicked thumbnail
      event.currentTarget.classList.add('active');

      // Move the carousel to the clicked image
      bootstrapCarousel.to(index);
    });
  });

  carousel.addEventListener('slid.bs.carousel', (event) => {
    // Remove active class from all thumbnails
    thumbnails.forEach(thumbnail => thumbnail.classList.remove('active'));

    // Add active class to the current thumbnail
    thumbnails[event.to].classList.add('active');
  });
});

document.addEventListener('DOMContentLoaded', () => {
  const availableDays = document.querySelectorAll('.available-day');

  availableDays.forEach(day => {
    day.addEventListener('click', (event) => {
      event.preventDefault();
      const selectedDate = day.getAttribute('data-date');
      document.getElementById('selected_date').value = selectedDate;
    });
  });
});

</script>



<div class="container">
  <!--<div id="<%= dom_id(@space) %>" class="space-images row">
    <% if @space.images.attached? %>
      <div class="large-image">
        <%= image_tag @space.images.first, id: "current-image", class: "current-image" %>
      </div>
      <div class="thumbnail-images">
        <% @space.images.each_with_index do |image, index| %>
          <%= image_tag image, class: "thumbnail #{'active' if index == 0}", data: { large_image: url_for(image), index: index } %>
        <% end %>
      </div>
      <div class="image-nav">
        <a href="javascript:void(0)" class="prev" onclick="changeImage(-1)">&#10094;</a>
        <a href="javascript:void(0)" class="next" onclick="changeImage(1)">&#10095;</a>
      </div>
    <% end %>
  </div>-->
  <div id="carouselExample" class="carousel slide" > <!-- 5000ms = 5 seconds OR use data-bs-ride="carousel" to make it change automatic -->
    <div class="carousel-inner">
      <% @space.images.each_with_index do |image, index| %>
        <div class="carousel-item <%= 'active' if index == 0 %>">
          <%= image_tag url_for(image), class: "d-block w-100 carousel-image", alt: "Space Image" %>
        </div>
      <% end %>
    </div>
    <button class="carousel-control-prev" type="button" data-bs-target="#carouselExample" data-bs-slide="prev">
      <span class="carousel-control-prev-icon" aria-hidden="true"></span>
      <span class="visually-hidden">Previous</span>
    </button>
    <button class="carousel-control-next" type="button" data-bs-target="#carouselExample" data-bs-slide="next">
      <span class="carousel-control-next-icon" aria-hidden="true"></span>
      <span class="visually-hidden">Next</span>
    </button>
  </div>

<div class="thumbnail-images d-flex justify-content-center flex-wrap mt-2">
    <% @space.images.each_with_index do |image, index| %>
      <%= image_tag url_for(image), class: "thumbnail #{'active' if index == 0}", data: { bs_target: '#carouselExample', bs_slide_to: index } %>
    <% end %>
  </div>

  <div class="row content-section">
    <div class="col-12 col-lg-6">
      <!-- Space details... -->
      <div class="space-title row">
            <%= space.title %>
      </div>

    <p>
      <%= space.city%> | <%= space.state %>| <%= country_name(space.country) %>
    </p>

    <div class="space-type-container">

      <% space.space_type.reject(&:blank?).each do |type| %>
        <div class="space-type-item">
          <i class="<%= icon_for_space_type(type) %>"></i>
          <span><%= type %></span>
        </div>
      <% end %>

    </div>


    <hr>

    <div style="display: block ruby;">
      <%= image_tag space.owner.profile_picture, class: "avatar-show"  %> <h5>Hosted by |<h5>  <%= space.owner.first_name %>
    </div>

    <hr>

    <div class=" row" >
      <p class="space-title">The Space:</p>
      <p style="font-size: 18px;white-space: pre-line;color: #606060;"><%= space.description %><p>
    </div>


    <hr style="margin-top: 0;">

    <div >

      <div style="display: flex;justify-content: space-around;">

          <div class="capacity-display">
            <i class="fas fa-users"></i>
            <span><%= space.capacity %> MAX</span>
            <!-- Use "fa-light fa-users" if you have access to FontAwesome Pro -->
          </div>


          <div class="houres">
            <i class="fas fa-clock"></i> <!-- Assuming you have an icon for the duration -->
            <span><%= space.minimum_rental_duration %> hrs minimum</span>
          </div>

      </div>

    </div>

    <hr>

    <div>

      <strong>Amenities:</strong>

      <ul class="amenities-list ">
        <% space.amenities.split(/\r?\n/).map(&:strip).each do |amenity| %>
          <li>
            <i class="<%= icon_for_amenity(amenity) %>"></i>
            <span><%= amenity.capitalize %></span>
          </li>
        <% end %>
      </ul>

    </div>

    <hr>

    <div >

          <p>
            <strong>Address:</strong>
            <%= space.address %>
          </p>

          <div>

              <div id="map_show"
                data-controller="map"
                      data-map-marker-value="<%= @marker.to_json %>"
                data-map-api-key-value="<%= ENV['GOOGLE_API_BROWSER_KEY'] %>"
                style="width: 100%; height: 400px;">
              </div>

          </div>

    </div>

    <hr>


      <p>
        <strong>State:</strong>
        <%= space.state %>
      </p>



      <p>
        <strong>Postal code:</strong>
        <%= space.postal_code %>
      </p>



      <p>
        <strong>Capacity:</strong>
        <%= space.capacity %>
      </p>



      <p>
        <strong>Price per hour:</strong>
        <%= space.price_per_hour %>
      </p>

      <p>
        <strong>Price per day:</strong>
        <%= space.price_per_day %>
      </p>

      <p>
        <strong>Start date:</strong>
        <%= space.start_date %>
      </p>

      <p>
        <strong>End date:</strong>
        <%= space.end_date %>
      </p>

      <p>
        <strong>Is hourly available:</strong>
        <%= space.is_hourly_available %>
      </p>

      <p>
        <strong>Is daily available:</strong>
        <%= space.is_daily_available %>
      </p>
    </div>


    <!-- Form Section -->
  <div class="form-section col-12 col-lg-6">
  <form>
    <div class="field">
      <label for="selected_date">Selected Date</label>
      <input type="text" id="selected_date" name="selected_date" readonly>
    </div>
    <div class="field">
      <label for="start_time">Start Time</label>
      <select id="start_time" name="start_time">
        <% generate_time_options(@space.available_from, @space.available_to).each do |time| %>
          <option value="<%= time.strftime("%H:%M") %>"><%= time.strftime("%I:%M %p") %></option>
        <% end %>
      </select>
    </div>
<%= render 'simple_calendar/calendar_view' %>
<input type="datetime-local">

  </form>
</div>

  </div>
</div>





<div class="field">
        <label for="start_time">Start Time</label>
        <select id="start_time" name="start_time">
          <% generate_time_options(@space.available_from, @space.available_to).each do |time| %>
            <option value="<%= time.strftime("%H:%M") %>"><%= time.strftime("%I:%M %p") %></option>
          <% end %>
        </select>
      </div>

      <div class="field">
        <label for="end_time">End Time</label>
        <select id="end_time" name="end_time">
          <% generate_time_options(@space.available_from, @space.available_to).each do |time| %>
            <option value="<%= time.strftime("%H:%M") %>"><%= time.strftime("%I:%M %p") %></option>
          <% end %>
        </select>
      </div>

    <!--<%= month_calendar do |date| %>
          <% if @space.start_date <= date && @space.end_date >= date && date >= Date.today %>
            <%= link_to date.day, "select_date_path(date: date, space_id: @space.id)", class: 'available-day' %>
          <% else %>
            <span><%= date.day %></span>
          <% end %>
        <% end %> -->
